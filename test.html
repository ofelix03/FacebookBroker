<!DOCTYPE html>
<html>
<head>
	<title></title>
	<style type="text/css" media="screen">
		#drop-zone {
			width: 150px;
			height: 150px;
			border: 1px solid #ddd;
			margin: auto auto;
			text-align: center;
			vertical-align: middle;
		}

		#images {
			margin-top: 50px;
		}


		#images:after {
			content: "";
			display: block;
			clear: both;
		}

		#images img {
			width: 150px;
			height: 150px;
			float: left;
		}


	</style>
</head>
<body>

	<div id="fileNum">File number</div>
	<div id="fileSize">file Size</div>
	<input type="file" name="photo" multiple onchange="handleFiles(this.files)" id="uploadInput"> 
	

	<div id="drop-zone">
		Drop image here to upload
	</div>
	<div id="images">

	</div>
	<script type="text/javascript">
		function updateSize() {
			var nBytes = 0,
			oFiles = document.getElementById("uploadInput").files,
			nFiles = oFiles.length;
			for (var nFileId = 0; nFileId < nFiles; nFileId++) {
				nBytes += oFiles[nFileId].size;
			}
			var sOutput = nBytes + " bytes";
		  // optional code for multiples approximation
		  for (var aMultiples = ["KiB", "MiB", "GiB", "TiB", "PiB", "EiB", "ZiB", "YiB"], nMultiple = 0, nApprox = nBytes / 1024; nApprox > 1; nApprox /= 1024, nMultiple++) {
		  	sOutput = nApprox.toFixed(3) + " " + aMultiples[nMultiple] + " (" + nBytes + " bytes)";
		  }
		  // end of optional code
		  document.getElementById("fileNum").innerHTML = nFiles;
		  document.getElementById("fileSize").innerHTML = sOutput;
		}


		var dropZoneElement = document.getElementById("drop-zone");
		dropZoneElement.addEventListener("dragenter", dragEnterFnc, false);
		dropZoneElement.addEventListener("dragover", dragOverFnc, false);
		dropZoneElement.addEventListener("drop", dropFnc, false);

		function dragEnterFnc(e) {
			console.log("Drag enter event activated");
			e.stopPropagation();
			e.preventDefault();
		}

		function dragOverFnc(e) {
			console.log("Drag over event activated");
			e.stopPropagation();
			e.preventDefault();
		}

		function dropFnc(e) {
			console.log("drop event activated");
			e.stopPropagation();
			e.preventDefault();

			var dt = e.dataTransfer;
			var files = dt.files;
			console.log('data transfer is ', dt);
			console.log('image files is ', files);

			handleFiles(files);
		}

		function handleFiles(files) {
			var preview = document.getElementById("images")
			for (var i = 0; i < files.length; i++) {
				var file = files[i];
				var imageType = /^image\//;

				if (!imageType.test(file.type)) {
					continue;
				}

				var img = document.createElement("img");
				img.classList.add("obj");
				img.file = file;
		    preview.appendChild(img); // Assuming that "preview" is the div output where the content will be displayed.

		    console.log("file url = " + window.URL.createObjectURL(file))
		    
		    var reader = new FileReader();
		    reader.onload = (function(aImg) { 
		    	return function(e) { 
		    		aImg.src = e.target.result; 
		    	}; 
		    })(img);

		    reader.onloadstart = (function(aImg) { 
		    	return function(e) { 
		    		console.log("onloadstart triggered");
		    		aImg.src = "img/ring.gif"; 
		    	}; 
		    })(img);


		    reader.readAsDataURL(file);
		}
	}
</script>

</body>
</html>